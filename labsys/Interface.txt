4/24/08 Laboratory SXI Interface Board

This board provide digital support and interfaces for the system:
video filtering and decimation, power conditioning, Camera Link
interface, and clock sequencing.

SeqCell.sch

This sequencer building block implements two finite state machine
bits. U1 decodes the conditions under which the corresponding bit
will change on the falling edge of CLK/:

J1A/	J1B/	K1A/	K1B/	Q1 becomes
0	0	0	0	~Q1
0	0	X	1	1
0	0	1	X	1
X	1	0	0	0
1	X	0	0	0
Any other			Q1

J2A/ etc. behave similarly.

DigitalDelay.sch

This building block delays a signal, In, by up to 7 cycles of Clk.
The delay isselected by D0-D3 (D0 is the least significant). It is
used to adjust the digital timing for the CCD clock driver
propagation delay.

decimator.sch

This is the decimation filter FPGA and with its support circuitry.

Interface.1.sch

This circuit employs the decimator block to turn video chip outputs
into Camera Link video, and sequencer timing signals into video chip
timing signals.

Interface.2.sch

This provides 3.3V power conditioning, other power connections, and
digital connections from the video board.

Interface.3.sch

This provides digital output connections to the video board, external
back bias, and connects to the temperature sensor on the CCD. Note
that "temp" and "temp2" connect directly to the sensor: there is no
circuitry in this system for measuring temperature.

Interface.4.sch

This delivers sequencer outputs and filtered 12V power to the driver
board.

Interface.5.sch

This delivers DAC control signals and power to the Drain Driver
board. For a P-channel CCD, DRV (from J3 on page 2) should be -30V,
and JS1 should be connected 1-2, 3-4. For an N channel CCD, DRV
should be +30V and JS1 should be connected 1-3, 2-4.

Interface.6.sch

This connects Camera Link with the decimator and with serial
port 1 on the EB40A microcontroller board. The connections to J1 here
can interfere with the operation of the microcontroller board. There
are several possibilities to avoid this:

1. Omit U13 here and use the SERIAL B connector on the
microcontroller board to control the camera instead of the Camera
Link serial interface. This is probably the best way to operate when
debugging.

2. Disable the serial connectors on the microcontroller board by
connecting jumper CB7. Control the camera through the Camera Link
serial connection. Unfortunately, this disables program loading
and debugging via SERIAL A, so it's not useful unless the SXI control
program has been placed in flash memory on the board.

3. Disconnect pin 10 of U10 on the microcontroller board. This
disables serial input from SERIAL B, but leaves other serial
functions intact. Control the camera through the Camera Link board.
Load and debug software through SERIAL A.

StateSeq.1.sch

This counts Sclk cycles within a pixel, and decodes them in octal.
If, for example, S1X/ and SX3/ are both low, the sequencer is in
state 013 (octal) or 11 (decimal). The count resets to zero following
state 023 (octal) or 19 (decimal). There are thus 20 (decimal) states
in a pixel, numbered 000 to 023 (octal).

Note that the counters are triggered on the positive edge of Sclk,
while the SeqCell blocks that use this information are triggered on
the negative edge. These outputs may thus be considered to anticipate
the states by 1/2 cycle if we consider the state to begin on the
falling edge of Sclk, which seems the most natural.

StateSeq.2.sch

This controls the timing of the following signals:

Name	Set	Clear	Purpose
Intu	015	000	Integrate to MD01 (undelayed)
Deintu	006	015	Deintegrate to MD01 (undelayed)
Clampu	005	006	Clamp to MD01 (undelayed)
Oddu	000	000	Odd to MD01 (undelayed)
SRG	002	022	Reset gate
Pdelay	005	001	For break-before make on vertical drivers
SPH	006	015	Horizontal clocks

The "Set" and "Clear" colums indicate the (octal) state at which the
signal is set to 1 or cleared to zero. Oddu toggles every 000 state
as long as VIEN is low, otherwise it is low: this logic assure that
the first pixel in a row is processed by the even modulators in the
MD01.

StateSeq.3.sch

U5 receives the clock control signals from the microcontroller and
synchronizes their changes with sequencer state 000. The signals P1V,
P2V, and P3V control the vertical clocks. VIEN determines whether
these drive the imaging area and frame store, or just the frame
store. PHEN enables the horizontal clocks, and SGEN enables the
summing gate clock.

StateSeq.4.sch

This combines Pdelay from page 2 with the parallel clock controls
from page three to create the logic drive for the parallel clock
drivers on the driver board.

StateSeq.5.sch

The horizontal clock drivers on the driver board have propagation
delays of ~200 ns. The digital delay blocks here allow the user to
delay the MD01 control signals to compensate, by using jumper block
J4 as follows:

Delay	J4(5-6)	J4(3-4) J4(1-2)
0	open	open	open
1	open	open	closed
2	open	closed	open
3	open	closed	closed
4	closed	open	open
5	closed	open	closed
6	closed	closed	open
7	closed	closed	closed

Delay is in units of Sclk cycles here. J4 also controls the pixel and
clock rates, as follows:

kpix/s	Sclk	Cclk	J4(7-8)	J4(9-10)
1000	20	100	open	open
500	10	50	closed	open
250	5	25	open	closed
125	2.5	12.5	closed	closed

Clock rates in MHz.



